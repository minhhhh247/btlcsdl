<!DOCTYPE html>
<html lang="vi" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đặt Phòng Khách Sạn</title>
    <link rel="stylesheet" href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="custom.css">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <i class="fas fa-hotel me-2"></i>RBook
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">
                            <i class="fas fa-home me-1"></i> Trang Chủ
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="search.html">
                            <i class="fas fa-search me-1"></i> Tìm Kiếm
                        </a>
                    </li>
                </ul>
            </div>
            
            
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mb-5">
        <div class="mb-4">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="index.html">Trang chủ</a></li>
                    <li class="breadcrumb-item"><a href="hotel_details.html">Chi tiết khách sạn</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Đặt phòng</li>
                </ol>
            </nav>
        </div>
        

        <!-- Loading Indicator -->
        <div id="loadingIndicator" class="text-center my-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Đang tải...</span>
            </div>
            <p class="mt-2">Đang tải thông tin phòng...</p>
        </div>

        <!-- Booking Form -->
        <div id="bookingForm" class="d-none">
            <h1 class="h3 mb-4">Đặt phòng</h1>
            
            <div class="row gx-4">
                <!-- Booking Form -->
                <div class="col-lg-8 mb-4 mb-lg-0">
                    <div class="card border-0 shadow mb-4">
                        <div class="card-body p-4">
                            <h2 class="h5 mb-4">Thông tin khách hàng</h2>
                            
                            <form id="bookingFormData">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="guestName" class="form-label">Họ tên <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control" id="guestName" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="guestEmail" class="form-label">Email <span class="text-danger">*</span></label>
                                        <input type="email" class="form-control" id="guestEmail" required>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="guestPhone" class="form-label">Số điện thoại</label>
                                        <input type="tel" class="form-control" id="guestPhone">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="numGuests" class="form-label">Số khách <span class="text-danger">*</span></label>
                                        <select class="form-select" id="numGuests" required>
                                            <option value="1">1 khách</option>
                                            <option value="2" selected>2 khách</option>
                                            <option value="3">3 khách</option>
                                            <option value="4">4 khách</option>
                                            <option value="5">5 khách</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="checkInDate" class="form-label">Ngày nhận phòng <span class="text-danger">*</span></label>
                                        <input type="date" class="form-control" id="checkInDate" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="checkOutDate" class="form-label">Ngày trả phòng <span class="text-danger">*</span></label>
                                        <input type="date" class="form-control" id="checkOutDate" required>
                                    </div>
                                </div>
                                
                                <div class="mb-4">
                                    <label for="specialRequests" class="form-label">Yêu cầu đặc biệt</label>
                                    <textarea class="form-control" id="specialRequests" rows="3" placeholder="Ghi chú thêm yêu cầu đặc biệt của bạn, nếu có"></textarea>
                                </div>
                                
                                <div class="alert alert-info mb-4" role="alert">
                                    <i class="fas fa-info-circle me-2"></i> Chúng tôi sẽ không tính phí đặt trước và bạn có thể hủy đặt phòng trước 24 giờ (tùy vào chính sách của khách sạn).
                                </div>
                                
                                <button type="submit" class="btn btn-primary btn-lg w-100 d-flex justify-content-center align-items-center gap-2">
                                    <i class="fas fa-check-circle"></i> Xác nhận đặt phòng
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
                
                <!-- Booking Summary -->
                <div class="col-lg-4">
                    <div class="card border-0 shadow sticky-top" style="top: 20px">
                        <div class="card-body p-4">
                            <h2 class="h5 mb-3">Thông tin đặt phòng</h2>
                            
                            <div id="bookingSummary">
                                <div class="d-flex align-items-center mb-3">
                                    <div class="flex-shrink-0 me-3" id="hotelThumbnail" style="width: 80px; height: 80px; background-size: cover; background-position: center; border-radius: 8px;"></div>
                                    <div>
                                        <h3 id="hotelName" class="h6 mb-1"></h3>
                                        <p id="hotelLocation" class="mb-0 small"></p>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <div class="fw-bold mb-2">Chi tiết phòng</div>
                                    <p id="roomName" class="mb-1"></p>
                                    <p id="roomCapacity" class="mb-0 small"></p>
                                </div>
                                
                                <hr class="my-3">
                                
                                <div class="mb-3">
                                    <div class="fw-bold mb-2">Ngày ở</div>
                                    <div class="d-flex justify-content-between mb-2">
                                        <span>Nhận phòng:</span>
                                        <span id="summaryCheckIn" class="text-end"></span>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <span>Trả phòng:</span>
                                        <span id="summaryCheckOut" class="text-end"></span>
                                    </div>
                                </div>
                                
                                <hr class="my-3">
                                
                                <div class="mb-0">
                                    <div class="fw-bold mb-2">Chi tiết giá</div>
                                    <div class="d-flex justify-content-between mb-2">
                                        <span id="nightsCount"></span>
                                        <span id="roomPrice" class="text-end"></span>
                                    </div>
                                    <div class="d-flex justify-content-between mb-2">
                                        <span>Thuế và phí dịch vụ:</span>
                                        <span id="taxesAndFees" class="text-end"></span>
                                    </div>
                                    <div class="d-flex justify-content-between fw-bold mt-3">
                                        <span>Tổng cộng:</span>
                                        <span id="totalPrice" class="text-end"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Error Message -->
        <div id="errorMessage" class="d-none">
            <div class="alert alert-danger" role="alert">
                <i class="fas fa-exclamation-circle me-2"></i>
                <span id="errorText">Không thể tải thông tin phòng. Vui lòng thử lại sau.</span>
            </div>
        </div>

        <!-- Processing Indicator (for form submit) -->
        <div class="modal fade" id="processingModal" tabindex="-1" aria-labelledby="processingModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-body text-center py-4">
                        <div class="spinner-border text-primary mb-3" role="status">
                            <span class="visually-hidden">Đang xử lý...</span>
                        </div>
                        <h5 id="processingModalLabel">Đang xử lý đặt phòng của bạn</h5>
                        <p class="mb-0 text-muted">Vui lòng đợi trong giây lát...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Success Modal -->
        <div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="successModalLabel">Đặt phòng thành công</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body text-center py-4">
                        <div class="text-success mb-3">
                            <i class="fas fa-check-circle fa-4x"></i>
                        </div>
                        <h5>Chúc mừng!</h5>
                        <p>Bạn đã đặt phòng thành công. Chúng tôi đã gửi xác nhận vào email của bạn.</p>
                        <p id="bookingReference" class="fw-bold"></p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Đóng</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-light py-4 mt-5">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-3">
                    <h5>RBook</h5>
                    <p>Trang web đặt phòng khách sạn hàng đầu.</p>
                </div>
                <div class="col-md-4 mb-3">
                    <h5>Liên Hệ</h5>
                    <ul class="list-unstyled">
                        <li><i class="fas fa-envelope me-2"></i>info@rbook.com</li>
                        <li><i class="fas fa-phone me-2"></i>+84 123 456 789</li>
                    </ul>
                </div>
                <div class="col-md-4 mb-3">
                    <h5>Theo Dõi</h5>
                    <div class="d-flex gap-3 fs-4">
                        <a href="#" class="text-light"><i class="fab fa-facebook"></i></a>
                        <a href="#" class="text-light"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="text-light"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
            </div>
            <hr>
            <div class="text-center">
                <p class="mb-0">&copy; 2025 RBook. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <script>
        // Mock hotel data for static version
        const mockHotelData = {
            id: 1,
            name: "Khách sạn Phú Quốc Resort & Spa",
            location: "Phú Quốc, Kiên Giang",
            description: "Khách sạn sang trọng bên bờ biển Phú Quốc với đầy đủ tiện nghi.",
            rating: 4.7,
            image_url: "https://placehold.co/600x400?text=Phu+Quoc+Resort",
            rooms: [
                {
                    id: 101,
                    name: "Phòng Deluxe Hướng Biển",
                    description: "Phòng rộng rãi với ban công nhìn ra biển.",
                    price_per_night: 2500000,
                    capacity: 2,
                    available: true
                }
            ]
        };

        /**
         * Initialize date pickers with default values
         */
        function initDatePickers() {
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            // Format dates for input elements
            const formatDate = (date) => {
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            };
            
            // Set default values for date inputs
            const checkInInput = document.getElementById('checkInDate');
            const checkOutInput = document.getElementById('checkOutDate');
            
            if (checkInInput && !checkInInput.value) {
                checkInInput.value = formatDate(today);
            }
            
            if (checkOutInput && !checkOutInput.value) {
                checkOutInput.value = formatDate(tomorrow);
            }
            
            // Update booking summary whenever dates change
            if (checkInInput && checkOutInput) {
                checkInInput.addEventListener('change', updateBookingSummary);
                checkOutInput.addEventListener('change', updateBookingSummary);
                document.getElementById('numGuests').addEventListener('change', updateBookingSummary);
            }
        }

        /**
         * Load booking details (static version)
         */
        function loadBookingDetails() {
            // Simulate loading delay for realistic effect
            setTimeout(() => {
                try {
                    const hotel = mockHotelData;
                    const room = hotel.rooms[0];
                    
                    if (!room) {
                        throw new Error('Room not found');
                    }
                    
                    // Update booking summary with hotel and room details
                    // Hotel info
                    document.getElementById('hotelName').textContent = hotel.name;
                    document.getElementById('hotelLocation').textContent = hotel.location;
                    
                    const hotelThumbnail = document.getElementById('hotelThumbnail');
                    hotelThumbnail.style.backgroundImage = `url(${hotel.image_url || 'https://placehold.co/600x400?text=Hotel+Image'})`;
                    
                    // Room info
                    document.getElementById('roomName').textContent = room.name;
                    document.getElementById('roomCapacity').textContent = `Tối đa ${room.capacity} khách`;
                    
                    // Hide loading, show form
                    document.getElementById('loadingIndicator').classList.add('d-none');
                    document.getElementById('bookingForm').classList.remove('d-none');
                    
                    // Update the summary
                    updateBookingSummary(room.price_per_night);
                } catch (error) {
                    console.error('Error loading booking details:', error);
                    document.getElementById('loadingIndicator').classList.add('d-none');
                    document.getElementById('errorMessage').classList.remove('d-none');
                    document.getElementById('errorText').textContent = 'Không thể tải thông tin phòng. Vui lòng thử lại sau.';
                }
            }, 1000); // 1 second delay for simulation
        }

        /**
         * Update booking summary with calculated prices and dates
         */
        function updateBookingSummary(roomPrice) {
            // Store room price in a data attribute if it's provided
            if (roomPrice) {
                document.getElementById('bookingSummary').dataset.roomPrice = roomPrice;
            } else {
                // Use stored room price
                roomPrice = parseFloat(document.getElementById('bookingSummary').dataset.roomPrice || 0);
            }
            
            // Get dates
            const checkInDate = new Date(document.getElementById('checkInDate').value);
            const checkOutDate = new Date(document.getElementById('checkOutDate').value);
            
            // Format dates for display
            const formatDisplayDate = (date) => {
                const options = { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' };
                return date.toLocaleDateString('vi-VN', options);
            };
            
            // Update dates in summary
            document.getElementById('summaryCheckIn').textContent = formatDisplayDate(checkInDate);
            document.getElementById('summaryCheckOut').textContent = formatDisplayDate(checkOutDate);
            
            // Calculate nights
            const nights = Math.max(1, Math.round((checkOutDate - checkInDate) / (1000 * 60 * 60 * 24)));
            
            // Calculate prices
            const basePrice = roomPrice * nights;
            const taxesAndFees = basePrice * 0.1; // 10% tax
            const totalPrice = basePrice + taxesAndFees;
            
            // Update price elements
            document.getElementById('nightsCount').textContent = `${nights} đêm x ${roomPrice.toLocaleString()} đ`;
            document.getElementById('roomPrice').textContent = `${basePrice.toLocaleString()} đ`;
            document.getElementById('taxesAndFees').textContent = `${taxesAndFees.toLocaleString()} đ`;
            document.getElementById('totalPrice').textContent = `${totalPrice.toLocaleString()} đ`;
        }

        /**
         * Submit booking information (static version)
         */
        function submitBooking() {
            // Show processing modal
            const processingModal = new bootstrap.Modal(document.getElementById('processingModal'));
            processingModal.show();
            
            // Get form data
            const guestName = document.getElementById('guestName').value;
            const guestEmail = document.getElementById('guestEmail').value;
            
            // Simulate API delay
            setTimeout(() => {
                // Hide processing modal
                processingModal.hide();
                
                // Generate random booking reference
                const bookingRef = 'RB' + Math.floor(100000 + Math.random() * 900000);
                document.getElementById('bookingReference').textContent = `Mã đặt phòng: ${bookingRef}`;
                
                // Show success modal
                const successModal = new bootstrap.Modal(document.getElementById('successModal'));
                successModal.show();
            }, 2000);
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize date pickers
            initDatePickers();
            
            // Load booking details (static version)
            loadBookingDetails();
            
            // Handle form submission
            document.getElementById('bookingFormData').addEventListener('submit', function(e) {
                e.preventDefault();
                submitBooking();
            });
        });
    </script>
</body>
</html>